from pathlib import Path
import re

p = Path("bot/app_factory.py")
s = p.read_text(encoding="utf-8").replace("\r\n","\n")

# Replace the user-facing Hebrew/labels in start_cmd/menu/health/vars/admin texts.
repls = {
    "SLH Guardian ? Security + Ops Control": "SLH Guardian ? Security + Ops Control",
    "???? ??? ?-SLH Guardian.": "???? ??? ?-SLH Guardian.",
    "????? ?????? ??????, ?????, ????? ?????, ????? ?-SaaS ???.": "????? ?????? ??????, ?????, ????? ?????, ????? ?-SaaS ???.",
    "??????:": "??????:",
    "/status    ????? DB/Redis/Alembic": "/status    ????? DB/Redis/Alembic",
    "/menu      ?????": "/menu      ?????",
    "/whoami    ?? ???": "/whoami    ?? ???",
    "/health    ??? ?????": "/health    ??? ?????",
    "/admin     ??? ?????": "/admin     ??? ?????",
    "?? WHOAMI": "?? WHOAMI",
    "?? ????? ??????:": "?? ????? ??????:",
    "?? ?????? ?????:": "?? ?????? ?????:",
    "?? HEALTH": "?? HEALTH",
    "?? VARS (SET/MISSING)": "?? VARS (SET/MISSING)",
    "?? WEBHOOK INFO": "?? WEBHOOK INFO",
    "?? DIAG": "?? DIAG",
    "?? BOOT/ADMIN REPORT": "?? BOOT/ADMIN REPORT",
}

for a,b in repls.items():
    s = s.replace(a, b)

# Also replace the non-admin denial text (if present)
s = s.replace("? ??? ?? ?????.", "? ??? ?? ?????.")

p.write_text(s, encoding="utf-8")
print("OK: app_factory UI text fixed")
